---
title: "class09_structural"
author: "Brad Hunter (PID: A69038089)"
format: pdf
prefer-html: true
---

## The PDB database

It's easier to import through **readr** package using the **read_csv()** function.

```{r}
library(readr)

data <- read_csv("Data_Export_Summary.csv")
data
```

> Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

The percentage of X-ray is `r round(sum(data$'X-ray')/sum(data$Total) *100,2)`% and `r round(sum(data$EM)/sum(data$Total) *100,2)`% for Electron Microscopy.

> Q2: What proportion of structures in the PDB are protein?

`r round(as.numeric(data[1,"Total"]) / sum(data$Total),2)`

> Q3: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

868

```{r}
library(ggplot2)
library(tidyr)

ggplot(data) +
  aes(reorder(`Molecular Type`,-Total),Total) +
  geom_col() +
  labs(title = "PDB Database Composition Oct 2025" ,y = "Number of Structures") +
  theme_classic()
```

## Visualizing structure data

Using Mol*

I can insert any figure or image file using markdown format: `![Description](name_of_image)`

![This is the HIV-Pr dimer with bound inhibitor](1HSG.png)

> Q4: Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?

To reduce the complexity of the model.

> Q5: There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have

yes, it is water 308.


> Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.

![The catalytic ASP25 and ](1HSG_water308.png)



## Bio3D package for structural bioinformatics

We can use the bio3D package to read and analyze biomolecular data in R:

```{r}
library(bio3d)

hiv <- read.pdb("1hsg")
hiv
```

> Q7: How many amino acid residues are there in this pdb object? 

198

> Q8: Name one of the two non-protein residues? 

MK1

> Q9: How many protein chains are in this structure? 

2


```{r}
head(hiv$atom)
```

Let's get the sequence

```{r}
pdbseq(hiv)
```

Let's trim to chain A and get just it's sequence

```{r}
chainA <-trim.pdb(hiv, chain="A")
chainA.seq <- pdbseq(chainA)
```

Let's blast 

![](blasting copy.jpg)

```{r blast_hiv, cache=TRUE}
blast <- blast.pdb(chainA.seq)
```

```{r}
head(blast$hit.tbl)
```

```{r}
hits <- plot(blast)
```

```{r}
hits$pdb.id
```

## Prediction of functional motions

We can run a Normal Analysis (NMA) to predict large scale motions/flexibility/dynamics of any biomolecules that we can read into R.

Let's look at ADK and chain A only.

```{r}
adk <- read.pdb("1ake")
adk_A <- trim.pdb(adk, chain="A")
adk_A
```

```{r}
m <- nma(adk_A)
plot(m)
```

Let's write out a "trajectory" of predicted motion

```{r}
mktrj(m, file="adk_nma.pdb")
```

## Play with 3D viewing in R

We can use the new **bio3dviewer** package, which is not yet on CRAN, to render interactive 3d views in R and HTML quarto output reports.

To install from GitHub, we can use the **pak** package.

```{r}
library(bio3dview)

#view.pdb(adk)
```

Download all these "hits" that are similar to our starting ID sequence
```{r}
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```

```{r}
# Align related PDBs
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
```

```{r}
pc.xray <- pca(pdbs)
plot(pc.xray)
```

```{r}
plot(pc.xray, 1:2)
```

```{r}
mktrj(pc.xray, file="pc_results.pdb")
```

```{r}
view.pca(pc.xray)
```



>Q10. Which of the packages above is found only on BioConductor and not CRAN? 

msa

>Q11. Which of the above packages is not found on BioConductor or CRAN?: 

bio3d-view

>Q12. True or False? Functions from the devtools package can be used to install packages from GitHub and BitBucket? 

TRUE

>Q13. How many amino acids are in this sequence, i.e. how long is this sequence? 

214
