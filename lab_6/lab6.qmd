---
title: "Lab 6 Functions"
author: "Brad Hunter (PID: A69038089)"
format: pdf
---

Example input data

```{r}
student1 <- c(100, 100, 100, 100, 100, 100, 100, 90)
student2 <- c(100, NA, 90, 90, 90, 90, 97, 80)
student3 <- c(90, NA, NA, NA, NA, NA, NA, NA)
```

Let's create a function to grade homework

>Q1 Write a function grade() to determine an overall grade from a vector of student homework
assignment scores dropping the lowest single score. If a student misses a homework (i.e. has an
NA value) this can be used as a score to be potentially dropped. Your final function should be
adquately explained with code comments and be able to work on an example class gradebook
such as this one in CSV format: “https://tinyurl.com/gradeinput” 

```{r}

#' Calculates average scores for a vector of homework scores.
#' Drops the lowest single score, NAs are counted as 0.
#'
#' @param d Numeric vector of homework scores
#'
#' @returns Average score
#' @export
#'
#' @examples
#'  student <- c(100, NA, 90, 90, 90, 90, 97, 80)
#'  grade(student)
#'  
grade <- function(d) {
 d[is.na(d)] <- 0
 mean(d[-which.min(d)]) 
}
```

Let's test our function

```{r}
grade(student1)
grade(student2)
grade(student3)
```

Let's input the test grades of the example grade book and calculate their grades.

```{r}
url <- "https://tinyurl.com/gradeinput"
book <- read.csv(url, row.names=1)
graded <- apply(book,1,grade)
graded
```

> Q2. Using your grade() function and the supplied gradebook, Who is the top scoring student
overall in the gradebook?

```{r}
names(graded)[which.max(graded)]
```

The student with the top score is `r names(graded)[which.max(graded)]`

> Q3. From your analysis of the gradebook, which homework was toughest on students (i.e. obtained
the lowest scores overall?

```{r}
assignments <- apply(book,2,median, na.rm=T)
names(assignments)[which.min(assignments)]
boxplot(book)
```

`r names(assignments)[which.min(assignments)]` was the toughest assignment for the students.

> Q4. Optional Extension: From your analysis of the gradebook, which homework was most
predictive of overall score (i.e. highest correlation with average grade score)?

```{r}
book[is.na(book)] <- 0
cor.grade <- apply(book,2,cor, x=graded)
cor.grade
```

The homework that was most predictive of overall score was `r names(cor.grade)[which.max(cor.grade)]`.