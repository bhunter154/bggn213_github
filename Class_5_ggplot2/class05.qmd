---
title: "Class 05: Data Visualization with GGPLOT"
author: "Brad Hunter (PID A69038089)"
format: pdf
---

Today we are playing with plotting and graphics in R.

There are **lots** of ways to make cool figures in R.
There is "base" R graphics (`plot()`, `hist()`, `boxplot()` etc.)

There is also add-on packages, like **ggplot2**


Let's play with the cars data set:
```{r}
head(cars,10)
```
Let's plot this with "base" R:
```{r}
plot(cars)
```

Let's plot mpg v. displacement
```{r}
plot(mtcars$mpg, mtcars$disp)
```


```{r}
hist(mtcars$mpg)
```



## Let's use GGPLOT

The main function in the ggplot2 package is `ggplot()`. First I need to install and load the **ggplot2** package. Installing using the `install.packages()` 

> **N.B.** I never want to run 'install.packages()' in my quarto source document!!

```{r}
library(ggplot2)
ggplot(cars) +
  aes(speed, dist) +
  geom_point()
```

```{r}
ggplot(cars) +
  aes(speed) +
  geom_histogram()
```

Every ggplot needs at least 3 things:

- The **data** component
- The **(aes)thetic** mapping
- The **(geom)etry** (i.e `geom_point()`)

> For simple canned graphs "base" R is nearly always faster but it isn't as customizable.

### Adding more layers ###

Let's add a line, a title, subtitle and captions and custom axis names

```{r}
ggplot(cars) +
  aes(speed, dist) +
  geom_point(color = "darkgreen") +
  geom_smooth(method = "lm", color = "rosybrown", se=FALSE) +
  labs(
    title    = "Cars Plot",
    subtitle = "learning GGPLOT2",
    x        = "Speed (MPH)",
    y        = "Distance (feet)",
    caption  = "I need caffeine"
  ) +
  theme_minimal() +
  theme(
    plot.title    = element_text(face = "bold", size = 14),
    plot.subtitle = element_text(size = 11, colour = "gray50")
  )
```

## Plot some expression data

Reading data filr from online URL

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

> Q1. How many genes are in this dataset?

There are `r nrow(genes)` in this dataset.

> Q2. How many "up" regulated genes are there?

There are `r sum(genes$State == 'up')` Up genes, as seen in this table

```{r}
table(genes$State)

p <- ggplot(genes) +
  aes(x=Condition1, y=Condition2, col=State) +
  geom_point() +
  scale_colour_manual( values=c("palegreen4","gray","coral") ) +
  labs(title="Drug-Induced Gene Expression Changes",
         x="Control (no drug) ",
         y="Drug Treatment",
         caption="I also need sleep")
p
```

Adding rediculous labels

```{r}
library(ggrepel)
ggplot(genes) +
  aes(x=Condition1, y=Condition2, col=State, label=Gene) +
  geom_point() +
  scale_colour_manual( values=c("palegreen4","gray","coral") ) +
  labs(title="Drug-Induced Gene Expression Changes",
         x="Control (no drug) ",
         y="Drug Treatment",
         caption="I also need sleep") +
  geom_text_repel(max.overlaps = 90) +
  theme_bw()

```

## Going Further

```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```

```{r}
head(gapminder)
```

```{r}
tail(gapminder)
```

```{r}
library(dplyr)

ggplot(gapminder) +
  aes(gdpPercap,lifeExp, col=continent, size=pop) +
  geom_point(alpha=0.5) +
  facet_wrap(~continent) +
  theme_bw()

```

##ANAMATION!!!!!

```{r}
library(gapminder)
library(gganimate)

# Setup nice regular ggplot of the gapminder data
ggplot(gapminder, aes(gdpPercap, lifeExp, size = pop, colour = country)) +
  geom_point(alpha = 0.7, show.legend = FALSE) +
  scale_colour_manual(values = country_colors) +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  # Facet by continent
  facet_wrap(~continent) +
  # Here comes the gganimate specific bits
  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +
  transition_time(year) +
  shadow_wake(wake_length = 0.1, alpha = FALSE)
```

